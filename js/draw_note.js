//////////////////////////////////////////
/////////VERTEX DATA FOR LETTERS//////////
//////////////////////////////////////////

var A = [{x:26,y:71},{x:52,y:15},{x:74,y:71},{x:57,y:71},{x:52,y:51},{x:47,y:71},{x:26,y:71},{x:56,y:44},{x:52,y:30},{x:48,y:44},{x:56,y:44}];

var B = [{x:28,y:9},{x:28,y:70},{x:73,y:70},{x:83,y:65},{x:87,y:55},{x:85,y:45},{x:78,y:39},{x:63,y:36},{x:75,y:32},{x:79,y:23},{x:78,y:15},{x:70,y:9},{x:28,y:9},{x:39,y:15},{x:60,y:17},{x:60,y:22},{x:39,y:25},{x:39,y:46},{x:66,y:51},{x:66,y:59},{x:39,y:60},{x:39,y:15}];

var C = [{x:80,y:17},{x:43,y:20},{x:35,y:29},{x:30,y:44},{x:32,y:56},{x:40,y:61},{x:56,y:62},{x:80,y:62},{x:80,y:52},{x:63,y:49},{x:50,y:41},{x:53,y:30},{x:80,y:30}];

var D = [{x:28,y:18},{x:28,y:71},{x:71,y:71},{x:81,y:63},{x:84,y:44},{x:82,y:31},{x:72,y:19},{x:28,y:18},{x:37,y:28},{x:61,y:29},{x:67,y:41},{x:66,y:53},{x:59,y:56},{x:37,y:55},{x:37,y:28}];

var E = [{x:28,y:14},{x:28,y:72},{x:77,y:72},{x:77,y:59},{x:49,y:59},{x:49,y:46},{x:64,y:46},{x:65,y:33},{x:49,y:33},{x:49,y:23},{x:77,y:23},{x:76,y:14}];

var F = [{x:30,y:12},{x:30,y:70},{x:48,y:70},{x:48,y:44},{x:64,y:44},{x:64,y:34},{x:48,y:34},{x:48,y:24},{x:76,y:24},{x:76,y:12}];

var G = [{x:83,y:14},{x:54,y:14},{x:37,y:20},{x:29,y:43},{x:32,y:61},{x:61,y:69},{x:89,y:69},{x:89,y:43},{x:61,y:41},{x:61,y:50},{x:77,y:50},{x:78,y:60},{x:61,y:58},{x:47,y:53},{x:44,y:39},{x:53,y:27},{x:83,y:27}];

var H = [{x:29,y:12},{x:29,y:70},{x:46,y:70},{x:46,y:51},{x:65,y:51},{x:65,y:70},{x:81,y:70},{x:81,y:12},{x:65,y:12},{x:65,y:33},{x:46,y:33},{x:46,y:12}];

var I = [{x:47,y:13},{x:47,y:72},{x:66,y:72},{x:66,y:13}];

var J = [{x:61,y:10},{x:61,y:51},{x:52,y:56},{x:40,y:56},{x:35,y:51},{x:26,y:51},{x:32,y:64},{x:49,y:67},{x:64,y:64},{x:72,y:51},{x:72,y:10}];

var K = [{x:37,y:13},{x:37,y:72},{x:54,y:72},{x:54,y:50},{x:65,y:72},{x:83,y:72},{x:60,y:36},{x:85,y:13},{x:64,y:13},{x:54,y:23},{x:54,y:13}];

var L = [{x:37,y:13},{x:37,y:69},{x:80,y:69},{x:80,y:56},{x:52,y:56},{x:52,y:13}];

var M = [{x:23,y:80},{x:23,y:19},{x:42,y:19},{x:57,y:40},{x:73,y:19},{x:92,y:19},{x:92,y:80},{x:73,y:80},{x:73,y:51},{x:57,y:62},{x:42,y:51},{x:42,y:80}];

var N = [{x:28,y:72},{x:28,y:16},{x:44,y:16},{x:56,y:45},{x:56,y:16},{x:71,y:16},{x:71,y:72},{x:58,y:72},{x:44,y:44},{x:43,y:72}];

var O = [{x:47,y:15},{x:33,y:23},{x:26,y:32},{x:24,y:49},{x:38,y:60},{x:59,y:60},{x:70,y:49},{x:70,y:28},{x:61,y:18},{x:47,y:15},{x:49,y:25},{x:57,y:29},{x:61,y:40},{x:51,y:51},{x:40,y:45},{x:38,y:31},{x:49,y:25}];

var P = [{x:33,y:15},{x:33,y:75},{x:48,y:75},{x:48,y:43},{x:72,y:42},{x:75,y:30},{x:73,y:19},{x:66,y:15},{x:33,y:15},{x:41,y:21},{x:62,y:22},{x:62,y:31},{x:41,y:32},{x:41,y:21}];

var Q = [{x:45,y:17},{x:35,y:22},{x:29,y:32},{x:27,y:49},{x:34,y:60},{x:50,y:62},{x:61,y:61},{x:68,y:53},{x:75,y:63},{x:81,y:59},{x:72,y:45},{x:70,y:32},{x:65,y:24},{x:57,y:19},{x:45,y:17},{x:46,y:27},{x:56,y:33},{x:57,y:45},{x:45,y:49},{x:40,y:37},{x:46,y:27}];

var R = [{x:33,y:12},{x:33,y:69},{x:47,y:69},{x:47,y:51},{x:59,y:69},{x:72,y:69},{x:56,y:35},{x:73,y:33},{x:75,y:22},{x:73,y:14},{x:33,y:12},{x:45,y:19},{x:61,y:20},{x:61,y:25},{x:45,y:27},{x:45,y:19}];

var S = [{x:76,y:13},{x:46,y:13},{x:33,y:16},{x:27,y:26},{x:29,y:37},{x:42,y:43},{x:57,y:47},{x:61,y:52},{x:58,y:59},{x:47,y:62},{x:26,y:63},{x:26,y:73},{x:59,y:72},{x:75,y:64},{x:77,y:48},{x:69,y:35},{x:47,y:28},{x:49,y:23},{x:76,y:23}];

var T = [{x:45,y:32},{x:45,y:72},{x:63,y:72},{x:63,y:32},{x:91,y:32},{x:91,y:16},{x:21,y:16},{x:21,y:32}];

var U = [{x:32,y:16},{x:32,y:58},{x:42,y:70},{x:54,y:73},{x:71,y:73},{x:78,y:70},{x:85,y:58},{x:85,y:16},{x:71,y:16},{x:71,y:51},{x:65,y:58},{x:51,y:58},{x:46,y:51},{x:45,y:16}];

var V = [{x:31,y:20},{x:55,y:71},{x:79,y:20},{x:64,y:20},{x:55,y:54},{x:46,y:20}];

var W = [{x:26,y:20},{x:38,y:69},{x:51,y:53},{x:64,y:69},{x:79,y:20},{x:67,y:20},{x:62,y:40},{x:51,y:30},{x:43,y:40},{x:39,y:20}];

var X = [{x:32,y:20},{x:47,y:20},{x:58,y:38},{x:65,y:20},{x:82,y:20},{x:64,y:46},{x:82,y:68},{x:65,y:68},{x:58,y:50},{x:47,y:68},{x:32,y:68},{x:52,y:46}];

var Y = [{x:31,y:15},{x:49,y:15},{x:58,y:32},{x:66,y:15},{x:85,y:15},{x:65,y:43},{x:65,y:69},{x:52,y:69},{x:52,y:43}];

var Z = [{x:27,y:15},{x:76,y:15},{x:43,y:53},{x:76,y:53},{x:76,y:65},{x:26,y:65},{x:47,y:25},{x:27,y:25}];

//////////////////////////////////////////

var w = window.innerWidth;
var h = window.innerHeight;
var objLimit = 50;

var Engine = Matter.Engine,
    World = Matter.World,
    Bodies = Matter.Bodies;

var engine = Engine.create(document.body, {
    render: {
        options: {
            height: h,
            width: w,
            showDebug: true,
            wireframes: false,
            background: "hsl(0,0%,10%)"
        }
    }
});
engine.timing.timeScale = 1.2;
engine.world.gravity.y = 2;
engine.world.bounds.max.x = w;
engine.world.bounds.max.y = h;

World.add(engine.world, Bodies.rectangle(w / 2, h - 160, 1050, 300, {
    isStatic: true,
    render: {
        fillStyle: "rgba(0,0,0,0)",
        strokeStyle: "rgba(0,0,0,0)"
    }
}));

Engine.run(engine);

var letters = {
    A: {
        name: "a",
        pos: -500,
        vertices: A
    },
    B: {
        name: "b",
        pos: 0,
        vertices: B
    },
    C: {
        name: "c",
        pos: -200,
        vertices: C
    },
    D: {
        name: "d",
        pos: -300,
        vertices: D
    },
    E: {
        name: "e",
        pos: -300,
        vertices: E
    },
    F: {
        name: "f",
        pos: -200,
        vertices: F
    },
    G: {
        name: "g",
        pos: 0,
        vertices: G
    },
    H: {
        name: "h",
        pos: 100,
        vertices: H
    },
    I: {
        name: "i",
        pos: 200,
        vertices: I
    },
    J: {
        name: "j",
        pos: 100,
        vertices: J
    },
    K: {
        name: "k",
        pos: 200,
        vertices: K
    },
    L: {
        name: "l",
        pos: 300,
        vertices: L
    },
    M: {
        name: "m",
        pos: 300,
        vertices: M
    },
    N: {
        name: "n",
        pos: 200,
        vertices: N
    },
    O: {
        name: "o",
        pos: 300,
        vertices: O
    },
    P: {
        name: "p",
        pos: 400,
        vertices: P
    },
    Q: {
        name: "q",
        pos: -500,
        vertices: Q
    },
    R: {
        name: "r",
        pos: -200,
        vertices: R
    },
    S: {
        name: "s",
        pos: -400,
        vertices: S
    },
    T: {
        name: "t",
        pos: -100,
        vertices: T
    },
    U: {
        name: "u",
        pos: 100,
        vertices: U
    },
    V: {
        name: "v",
        pos: -100,
        vertices: V
    },
    W: {
        name: "w",
        pos: -400,
        vertices: W
    },
    X: {
        name: "x",
        pos: -300,
        vertices: X
    },
    Y: {
        name: "y",
        pos: 0,
        vertices: Y
    },
    Z: {
        name: "z",
        pos: -400,
        vertices: Z
    }
};

function createBox(x, y, key) {
    return Matter.Body.create({
        position: {
            x: x,
            y: y
        },
        vertices: JSON.parse(JSON.stringify(letters[key].vertices)),
        mass: 0.0017,
        friction: 0,
        restitution: 1
    });
}

var boxes = [];

$(document).keydown(function(e) {
    var key = String.fromCharCode(e.which);
    if(key in letters){
        addLetter(key);
        hilight(letters[key].name);
    }
});

function addLetter(e) {
    var box = createBox(window.innerWidth / 2 + letters[e].pos, window.innerHeight - 300, e);

    box.angle = Math.random() * 0.5 - 0.25;
    box.force.y -= 0.00015;
    boxes.push(box);
    World.add(engine.world, boxes[boxes.length - 1]);

    if (boxes.length > objLimit) {
        World.remove(engine.world, boxes[0]);
        boxes = boxes.slice(1);
    }
}

function hilight(key) {
    $("#" + key).addClass("hilight");
    setTimeout(function() {
        $("#" + key).removeClass("hilight");
    }, 500);
}

$(".key").bind("click touch",function(e) {
    e.preventDefault();
    var key = String.fromCharCode($(this).attr("id").charCodeAt(0)).toUpperCase();
    if(key in letters){
        addLetter(key);
        hilight($(this).attr("id"));
    }
});